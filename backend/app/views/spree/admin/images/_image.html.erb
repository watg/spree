<tr id="<%= spree_dom_id image %>" data-hook="images_row" class="<%= cycle('odd', 'even')%>">
  <td class="no-border">
    <span class="handle"></span>
  </td>
  <td>
    <% if image.processed? %>
      <%= link_to image_tag(image.attachment.url(:small), style: "max-width: 180px"), image.attachment.url(:product) %>
    <% else %>
      <%= link_to image_tag(image.direct_upload_url, style: "max-width: 180px"), image.attachment.url(:product) %>
    <% end %>
  </td>
  
  <td style="vertical-align: top">
    <%= form_for [:admin, @product, image], remote: true do |f| %>
      <%= f.label :variant_id, Spree.t(:variant) %><br>
      <%= select_tag 'image[variant_id]', options_for_select(@variants, get_variant_id(image), :class => 'select3' %><br><br>
      
      <%= f.label :target_id, "Target" %><br>
      <%= select_tag 'image[target_id]', options_from_collection_for_select(Spree::Target.all, 'id', 'name', image.try(:target_id)), include_blank: true, class: 'select3' %>

    <% end %>
  </td>           

  <td class="actions">
    <%= link_to '', '#', :class => 'save-item icon_link icon-ok no-text with-tip', :title => Spree.t('actions.save'), :onclick=>"$('#edit_image_#{image.id}').submit(); return false;" %>

    <%= link_to_with_icon 'icon-edit', Spree.t(:edit), edit_admin_product_image_url(@product, image), :no_text => true, :data => {:action => 'edit'} %>
    <%= link_to_delete image, { :url => admin_product_image_url(@product, image), :no_text => true } %>
  </td>
</tr>