<%= render :partial => 'spree/admin/shared/product_sub_menu' %>

<%= render :partial => 'spree/admin/shared/product_tabs', :locals => {:current => 'Product Images'} %>

<% content_for :page_actions do %>
  <li><%= link_to_with_icon('fa fa-refresh', Spree.t(:update), '#', :class => 'button update_all_images') %></li>
  <li><%= link_to_with_icon('fa fa-plus', Spree.t(:new_image), new_admin_product_image_url(@product), :id => 'new_image_link', :class => 'button') %></li>
<% end %>


<div id="images" data-hook></div>

<fieldset>
  <legend align="center">Upload to S3</legend>

  <div id="uploads_container"></div>
  <script id="template-upload" type="text/x-tmpl">
    <div id="upload_{%=o.unique_id%}" class="upload">
      <h5>{%=o.name%}</h5>
      <div class="progress progress-striped active"><div class="bar" style="width: 0%"></div></div>
    </div>
  </script>

  <%= render 'spree/admin/shared/image_upload_form', s3_callback_path: s3_callback_admin_product_images_path %>

</fieldset>



<table class="index sortable" data-hook="images_table" data-sortable-link="<%= update_positions_admin_product_images_url(@product) %>">
  <colgroup>
    <col style="width: 5%">
    <col style="width: 30%">
    <col style="width: 50%">
    <col style="width: 15%">
  </colgroup>
  <thead>
    <tr data-hook="images_header">
      <th colspan="2"><%= Spree.t(:small) %></th>
      <th><%= Spree::Variant.model_name.human %></th>
      <th class="actions"></th>
    </tr>
  </thead>

  <tbody id="images_table_body">
    <% unless @product.images.any? || @product.personalisation_images.any? %>
      <div class="no-objects-found">
        <%= Spree.t(:no_images_found) %>.
      </div>
    <% else %>
      <%= render partial: 'image', collection: @product.images %>
      <%= render partial: 'image', collection: @product.personalisation_images %>
    <% end %>
  </tbody>
</table>

<br>
<div class="form-buttons filter-actions actions">
  <%= link_to_with_icon('fa fa-refresh', Spree.t(:update), '#', :class => 'button update_all_images') %>
  <span class="or"><%= Spree.t(:or) %></span>
  <%= button_link_to Spree.t('actions.cancel'), collection_url, :icon => 'fa fa-remove' %>
</div>


