<tr id="<%= spree_dom_id image %>" data-hook="images_row" class="<%= cycle('odd', 'even')%>">
  <td class="no-border">
    <span class="handle"></span>
  </td>
  <td>
    <% if image.processed? %>
      <%= link_to image_tag(image.attachment.url(:small), style: "max-width: 180px"), image.attachment.url(:product) %>
    <% else %>
      <%= link_to image_tag(image.direct_upload_url, style: "max-width: 180px"), image.attachment.url(:product) %>
    <% end %>
  </td>
  
  <td>
    <%= form_tag spree.admin_variant_image_path(@variant,image), remote: true, :method => :put, :class => "edit_image", :id => "edit_image_#{image.id}" do %>

    <fieldset>
      <div class='<%="image-variant-#{image.id}"%>'>
      <%= label :target_id, "Target" %><br>
      <%= select_tag 'target_id', options_from_collection_for_select(Spree::Target.all, 'id', 'name', image.try(:target_id)), include_blank: true, class: 'select2' %>
    </div>
    </fieldset>

  <% end %>
  </td>           

  <td class="actions">
    <%= link_to '', '#', :class => 'save-item icon_link icon-ok no-text with-tip', :title => Spree.t('actions.save'), :onclick=>"$('#edit_image_#{image.id}').submit(); return false;" %>

    <%= link_to_with_icon 'icon-edit', Spree.t(:edit), edit_admin_variant_image_url(@variant, image), :no_text => true, :data => {:action => 'edit'} %>
    <%= link_to_delete image, { :url => admin_variant_image_url(@variant, image), :no_text => true } %>
  </td>
</tr>
